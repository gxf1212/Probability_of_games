# 长春麻将“蛋”概率实测报告

## 一、规则背景：什么是“蛋”？

1. **基础牌量**：长春麻将去掉花牌、季节牌，共 136 张；开局每人 14 张。本次模拟完全基于这套牌墙。
2. **蛋型速览**：
   - **旋风蛋**：东南西北齐全，俗称“风圈杠”，本模型要求四风俱全；
   - **（可选）三风蛋**：任意三张不同的风牌，本文未纳入，但同样可用保存的牌谱另行判断；
   - **喜蛋**：中、发、白三元齐全；
   - **幺 / 九蛋**：万、饼、索的 1 或 9 各一张，分成幺蛋和九蛋两种番型；
   - **大蛋**：幺鸡、幺饼、红中、发财、白板任意组成的杠；
   - **杠蛋**：任意四张完全相同牌组成的暗杠，不允许赖子凑。
3. **赖子设定**：幺鸡（1 索）是唯一的万能宝，最多顶替旋风蛋 3 张、喜 / 幺九蛋 2 张；当 1 索直接用在幺蛋本身时，记为纯净蛋，不算赖子。
4. **判定口径**：仅看“起手 14 张”能否直接组成蛋，不考虑吃碰杠或摸牌后的变化，等价于组合概率问题。

> **为什么强调规则？** 不同牌友圈对赖子、蛋型、是否必须带“叉”等要求不一。本文遵循“旋风必须四风齐 + 暗杠可立即算蛋”的线上主流设定（波克、QQ 长春麻将等），以便讨论具有共识基础。若需纳入三风蛋或其他玩法，可在保存的牌谱上追加判定。

## 二、模拟方法：蒙特卡罗

- 抽样次数：100,000 次；
- 随机种子：20251204（方便复现和对比结果）；
- 每轮从 136 张牌墙随机抽 14 张作为起手，判断是否立即满足任意蛋型；
- 同步记录纯净蛋、赖子蛋以及单手可叠的蛋数量；

## 三、结果解读：数据如何落到牌桌

### 1. 各蛋命中率
- 总体：29.72% 的起手至少有一组蛋；纯净蛋 12.61%，其余 19.70% 需要幺鸡补齐。
- 九蛋 / 喜蛋：命中率分别 14.43%、14.30%，是最常见的“双子星”。
- 旋风蛋：受“四风齐”限制仅 6.21%，但 80%（5.02%）依靠幺鸡补位。
- 幺蛋：6.34%，因为幺鸡既当赖子又当自身成员，纯净占比 60% 以上。
- 大蛋 / 杠蛋：概率仅 0.04%、0.202%，相当于彩蛋或“起手暗杠”的事件。

![各类蛋概率饼图](figures/egg_probabilities.png)

### 2. 纯净 vs. 赖子贡献
旋风、喜、九三类蛋的赖子依赖度都超过 70%，手里抓到幺鸡就不要轻易打掉。幺蛋的赖子柱较短，是因为只有当幺鸡去补“一万”或“一饼”的缺口时才记为“赖子贡献”，如果它直接作为幺蛋成员，就计入纯净。整体来看，赖子把命中率从 12.61% 拉高到 29.72%，贡献 **+17.1 个百分点** 的起手爆发力，与牌桌经验高度吻合。

![纯净赖子柱状图](figures/egg_purity.png)

具体数值如下：

| 蛋型 | 含赖子 | 纯净 | 赖子协助 |
| --- | --- | --- | --- |
| 旋风蛋 | 6.209% | 1.189% | 5.020% |
| 喜蛋 | 14.297% | 3.795% | 10.502% |
| 幺蛋 | 6.336% | 3.833% | 2.503% |
| 九蛋 | 14.432% | 3.911% | 10.521% |
| 大蛋 | 0.040% | 0.040% | 0.000% |
| 杠蛋 | 0.202% | 0.202% | 0.000% |

### 3. 多蛋叠加

![蛋组合分布](figures/egg_combo_distribution.png)

十万次样本只有 13 次出现“三蛋并飞”，全部由“旋风 + 喜 + 九”或“旋风 + 幺 + 九”组成，说明只有同时拥有风牌对子与幺鸡时才值得冲多蛋；否则盲拆对子、硬凑番型往往得不偿失。

### 4. 收敛性
![收敛性分析](figures/convergence.png)

含赖子、纯净蛋以及每种蛋型的累计概率在 50,000 次左右就进入稳定区间，再往上样本只是减少小数点噪音。喜蛋 / 九蛋曲线最平滑，旋风 / 杠蛋因概率低波动稍大，但 80,000 次后亦趋于稳定。想自行复现，只需基于 `hands.parquet` 换判定逻辑即可。

## 四、实战指南：把概率变成决策

1. **幺鸡管理**：如果手里有两张及以上幺鸡，优先考虑旋风 / 喜 / 幺九多蛋路线；手牌完全不配合时再考虑弃鸡。
2. **对子别乱拆**：未见风牌或三元露面时先观察局势；赖子补位成功率只有约 10%，盲拆等于浪费潜力。

## 五、文件清单与复现方式

仓库地址：https://github.com/gxf1212/Probability_of_games/cc_majong

- `data/hands.parquet`：100,000 组起手的 14 张 tile id，可在新规则下复用。
- `output/results.parquet`：当前规则下的逐手判定结果。
- `output/summary.json`：统计指标（概率、分布、收敛曲线）。
- `output/figures/*.png`：四张中文图，分别对应饼图、柱状图、组合分布、收敛曲线。

复现命令：
1. `PYTHONPATH=cc_majong/src python3 -m cc_majong.pipeline --seed 20251204`
2. 若需更大样本，加 `--trials`；若需重新抽牌，加 `--regen-samples`。

## 参考资料
1. [Pook 休闲桌游网：《长春麻将怎么玩》](https://www.pook.com/archives/326.html)
2. [集合啦棋牌网：《吉林麻将（长春麻将）规则》](https://www.zadiqp.com/rules/jilinmajiang.html)
